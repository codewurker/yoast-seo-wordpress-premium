"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[280],{2989:(e,t,r)=>{var i=r(8368);const o=function(e){this.form=e};o.prototype.getOriginField=function(){return this.form.find("input[name=wpseo_redirects_origin]")},o.prototype.getTargetField=function(){return this.form.find("input[name=wpseo_redirects_target]")},o.prototype.getTypeField=function(){return this.form.find("select[name=wpseo_redirects_type]")},o.prototype.clearErrorMessage=function(){this.form.find(".wpseo_redirect_form .form_error").remove()},o.prototype.setErrorMessage=function(e){this.form.find(".wpseo_redirect_form").prepend('<div class="form_error error"><p>'+e+"</p></div>")},o.prototype.removeRowHighlights=function(){this.form.find(".redirect_form_row").removeClass("field_error")},o.prototype.highLightRowErrors=function(e){for(let t=0;t<e.length;t++)switch(e[t]){case"origin":this.highlightRow(this.getOriginField());break;case"target":this.highlightRow(this.getTargetField());break;case"type":this.highlightRow(this.getTypeField())}},o.prototype.highlightRow=function(e){jQuery(e).closest("div.redirect_form_row").addClass("field_error")};const n=o,s=function(e,t){this.form=e,this.type=t,this.validationError=""};s.prototype.validate=function(){return this.form.clearErrorMessage(),this.form.removeRowHighlights(),!1!==this.runValidation(this.form.getOriginField(),this.form.getTargetField(),this.form.getTypeField())||(this.addValidationError(this.validationError),!1)},s.prototype.runValidation=function(e,t,r){if(""===e.val())return this.form.highlightRow(e),"plain"===this.type?this.setError(wpseoPremiumStrings.error_old_url):this.setError(wpseoPremiumStrings.error_regex);if(-1===jQuery.inArray(parseInt(r.val(),10),i.ALLOW_EMPTY_TARGET)){if(""===t.val())return this.form.highlightRow(t),this.setError(wpseoPremiumStrings.error_new_url);if(t.val()===e.val())return this.form.highlightRow(t),this.setError(wpseoPremiumStrings.error_circular)}return""!==r.val()||(this.form.highlightRow(r),this.setError(wpseoPremiumStrings.error_new_type))},s.prototype.setError=function(e){return this.validationError=e,!1},s.prototype.addValidationError=function(e,t=null){this.form.setErrorMessage(e),void 0!==t&&this.form.highLightRowErrors(t)},s.prototype.getFormValues=function(){const e={origin:this.form.getOriginField().val().toString(),target:this.form.getTargetField().val().toString(),type:this.form.getTypeField().val().toString()};return jQuery.inArray(parseInt(e.type,10),i.ALLOW_EMPTY_TARGET)>-1&&(e.target=""),e};const a=s,d=function(){this.row=null,this.quickEditRow=null,this.templateQuickEdit=wp.template("redirects-inline-edit")};d.prototype.setup=function(e,t){this.row=e,this.quickEditRow=jQuery(this.templateQuickEdit({origin:_.unescape(t.origin.html()),target:_.unescape(t.target.html()),type:parseInt(t.type.html(),10),suffix:jQuery("#the-list").find("tr").index(e)}))},d.prototype.getRow=function(){return this.row},d.prototype.getForm=function(){return this.quickEditRow},d.prototype.show=function(){this.row.addClass("hidden"),this.quickEditRow.insertAfter(this.row).show(400,(function(){jQuery(this).find(":input").first().trigger("focus")}))},d.prototype.remove=function(){this.row.removeClass("hidden"),this.quickEditRow.remove()};const c=d;!function(e){const t=window.wpseoAdminRedirect.homeUrl||"",r=function(e){return e&&"/"===e.charAt(0)?e.slice(1):e},o=new c;e.widget("ui.dialog",e.ui.dialog,{_createOverlay:function(){this._super(),this.options.modal&&this._on(this.overlay,{click:function(e){this.close(e)}})}}),e.fn.wpseoRedirects=function(s){const d=this,c=s.replace("table-","");let l,p=!1,u=null;const h=function(){p=!1,l=null},g=(e,t=null)=>{const{buttonValue:r,className:i="button"}=e;return{text:r,class:i,click:function(){null!==t&&t(),jQuery(this).dialog("close")}}};this.getButtons=function(e){return"default"===e?[g({buttonValue:wpseoPremiumStrings.button_ok})]:[g({buttonValue:wpseoPremiumStrings.button_cancel},(()=>{h()})),g({buttonValue:wpseoPremiumStrings.button_save_anyway,className:"button-primary"},(()=>{p=!0,l(),h()}))]},this.rowCells=function(e){const t=e.find(".val");return{origin:t.eq(1),target:t.eq(2),type:t.eq(0)}},this.dialog=function(t,r,i){void 0!==i&&"error"!==i||(i="default");const o=this.getButtons(i);e("#YoastRedirectDialogText").html(r),e("#YoastRedirectDialog").dialog({title:t,width:500,draggable:!1,resizable:!1,position:{at:"center center",my:"center center",of:window},buttons:o,modal:!0,close:function(){u&&u.trigger("focus")}})},this.openDialog=function(e){this.dialog(e.title,e.message)},this.post=function(t,r){e.post(ajaxurl,t,r,"json")},this.editRow=function(t){e("#the-list").find("#inline-edit").length>0?this.dialog(wpseoPremiumStrings.edit_redirect,wpseoPremiumStrings.editing_redirect):(o.setup(t,this.rowCells(t)),o.show(),new n(o.quickEditRow).getTypeField().trigger("change"))},this.prepareNewUrl=function(i,o){const n=["val"];if(o.isTargetRelative&&"/"!==i||n.push("remove-slashes"),o.hasTrailingSlash&&n.push("has-trailing-slash"),i){let s=i;return o.isTargetRelative&&(s=t+s),e("<a>").addClass(n.join(" ")).attr({href:_.escape(r(s)),target:"_blank"}).html(_.escape(i))}return e("<div>").addClass("val remove-slashes")},this.createRedirectRow=function(i,o,n,s){const a=e("#the-list tr").length+1;return e("<tr>").append(e("<th>").addClass("check-column").attr("scope","row").append(e("<label>").addClass("screen-reader-text").attr("for","wpseo-redirects-bulk-cb-"+a).html("Select this redirect"),e("<input>").attr("type","checkbox").attr("name","wpseo_redirects_bulk_delete[]").attr("id","wpseo-redirects-bulk-cb-"+a).val(_.escape(i)))).append(e("<td>").addClass("type column-type has-row-actions column-primary").append(e("<div>").addClass("val type").html(_.escape(n))).append(e("<div>").addClass("row-actions").append(e("<span>").addClass("edit").append(e("<a>").attr({href:"#",role:"button",class:"redirect-edit"}).html(wpseoPremiumStrings.editAction)).append(" | ")).append(e("<span>").addClass("trash").append(e("<a>").attr({href:"#",role:"button",class:"redirect-delete"}).html(wpseoPremiumStrings.deleteAction))))).append(e("<td>").addClass("column-old").append("regex"===c?e("<div>").addClass("val remove-slashes").html(_.escape(i)):e("<a>").addClass("val").attr({href:_.escape(t+r(i)),target:"_blank"}).html(_.escape(i)))).append(e("<td>").addClass("column-new").append(this.prepareNewUrl(o,s)))},this.handleError=function(e,t){e.addValidationError(t.message,t.fields),"warning"===t.type&&d.dialog(wpseoPremiumStrings.error_saving_redirect,t.message,t.type)},this.addRedirect=function(){const t=new n(e(".wpseo-new-redirect-form")),r=new a(t,c);if(!1===r.validate())return!1;const i=r.getFormValues();return d.post({action:"wpseo_add_redirect_"+c,ajax_nonce:e(".wpseo_redirects_ajax_nonce").val(),redirect:{origin:encodeURIComponent(i.origin),target:encodeURIComponent(i.target),type:i.type},ignore_warning:p},(function(i){if(i.error)return d.handleError(r,i.error),!0;t.getOriginField().val(""),t.getTargetField().val(""),d.find(".no-items").remove();const o=d.createRedirectRow(i.origin,i.target,i.type,i.info);e("form#"+c).find("#the-list").prepend(o),d.openDialog(wpseoPremiumStrings.redirect_added)})),!0},this.updateRedirect=function(){const i=new n(o.getForm()),s=new a(i,c);if(!1===s.validate())return!1;const l=s.getFormValues(),u=o.getRow(),h=this.rowCells(u);return d.post({action:"wpseo_update_redirect_"+c,ajax_nonce:e(".wpseo_redirects_ajax_nonce").val(),old_redirect:{origin:encodeURIComponent(h.origin.html()),target:encodeURIComponent(h.target.html()),type:encodeURIComponent(h.type.html())},new_redirect:{origin:encodeURIComponent(l.origin),target:encodeURIComponent(l.target),type:encodeURIComponent(l.type)},ignore_warning:p},(function(i){if(i.error)return d.handleError(s,i.error),!0;if(h.origin.html(_.escape(i.origin)),"regex"!==c&&h.origin.attr("href",_.escape(t+i.origin)),h.target.html(_.escape(i.target)),410===i.type||451===i.type)h.target.replaceWith(e("<div>").addClass("val remove-slashes"));else{const o="/"===i.target?"val remove-slashes":"val";h.target.replaceWith(e("<a>").addClass(o).attr({href:_.escape(t+r(i.target)),target:"_blank"}).html(_.escape(i.target)))}h.type.html(_.escape(i.type)),o.remove(),d.openDialog(wpseoPremiumStrings.redirect_updated)})),!0},this.deleteRedirect=function(t){const r=this.rowCells(t),o=r.origin.text(),n=r.target.text(),s=r.type.html();(0,i.wpseoDeleteRedirect)(o,n,s,c).then((r=>{t.fadeTo("fast",0).slideUp((function(){e(this).remove()})),d.openDialog(r)})).catch((e=>{this.dialog(e.title,e.message,"error")}))},this.setup=function(){let t;e("body").append('<div id="YoastRedirectDialog"><div id="YoastRedirectDialogText"></div></div>'),e(window).on("beforeunload",(function(){if(e("#the-list").find("#inline-edit").length>0)return wpseoPremiumStrings.unsaved_redirects})),e(".redirect-table-tab").on("change","select[name=wpseo_redirects_type]",(t=>{const r=parseInt(e(t.target).val(),10),o=e(t.target).closest(".wpseo_redirect_form").find(".wpseo_redirect_target_holder");jQuery.inArray(r,i.ALLOW_EMPTY_TARGET)>-1?e(o).hide():e(o).show()})),e(".wpseo-new-redirect-form").on("click",".button-primary",(function(){return l=function(){d.addRedirect()},d.addRedirect(),u=e(this),!1})).on("keypress","input",(function(e){13===e.which&&(l=function(){d.addRedirect()},e.preventDefault(),d.addRedirect())})),e(".wp-list-table").on("click",".redirect-edit",(function(r){t=e(r.target).closest("tr"),r.preventDefault(),d.editRow(t),u=e(this)})).on("click",".redirect-delete",(function(r){t=e(r.target).closest("tr"),r.preventDefault(),d.deleteRedirect(t),u=e("#cb-select-all-1")})).on("keypress","input",(function(e){13===e.which&&(l=function(){d.updateRedirect()},e.preventDefault(),d.updateRedirect())})).on("click",".save",(function(){l=function(){d.updateRedirect()},l()})).on("click",".cancel",(function(){l=null,o.remove(),t.find(".redirect-edit").trigger("focus")}))},d.setup()},e((function(){e.each(e(".redirect-table-tab"),(function(t,r){e(r).wpseoRedirects(e(r).attr("id"))}))}))}(jQuery)},8368:(e,t,r)=>{r.r(t),r.d(t,{ALLOW_EMPTY_TARGET:()=>n,wpseoCreateRedirect:()=>p,wpseoDeleteRedirect:()=>s,wpseoRemoveNotification:()=>d,wpseoUndoRedirect:()=>c,wpseoUndoRedirectByObjectId:()=>l,wpseoUndoRedirectForObject:()=>a});var i=r(1455),o=r.n(i);const n=[410,451];function s(e,t,r,i="plain"){return o()({method:"POST",url:wpApiSettings.root+"yoast/v1/redirects/delete",headers:{"X-WP-Nonce":wpApiSettings.nonce},data:{origin:e,target:t,type:r,format:i}})}function a(e,t){return o()({method:"POST",url:wpApiSettings.root+"yoast/v1/redirects/undo-for-object",headers:{"X-WP-Nonce":wpApiSettings.nonce},data:{obj_id:e,obj_type:t}})}function d(e){jQuery(e).closest(".yoast-notification").fadeOut("slow")}function c(e,t,r,i,o){s(e,t,r).then((e=>{!0===e.success&&d(o)}))}function l(e,t,r){a(e,t).then((e=>{!0===e.success&&d(r)}))}function p(e,t,r,i){var o="";410===parseInt(t,10)||""!==(o=window.prompt(wpseoPremiumStrings.enter_new_url.replace("%s",e)))?jQuery.post(ajaxurl,{action:"wpseo_add_redirect_plain",ajax_nonce:r,redirect:{origin:e,target:o,type:t}},(function(e){var r=jQuery(i).closest(".yoast-notification");if(jQuery(r).removeClass("updated").removeClass("error"),jQuery(r).find(".redirect_error").remove(),e.error)jQuery(r).addClass("error").prepend('<p class="redirect_error">'+e.error.message+"</p>");else{var o="";o=(o=410===parseInt(t,10)?_.escape(wpseoPremiumStrings.redirect_saved_no_target):wpseoPremiumStrings.redirect_saved.replace("%2$s","<code>"+_.escape(e.target)+"</code>")).replace("%1$s","<code>"+_.escape(e.origin)+"</code>"),jQuery(r).addClass("updated").html("<p>"+o+"</p>")}}),"json"):window.alert(wpseoPremiumStrings.error_new_url)}},1455:e=>{e.exports=window.wp.apiFetch}},e=>{e(e.s=2989)}]);